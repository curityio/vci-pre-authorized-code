<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <services>
        <service-role>
          <id>default</id>
          <endpoints>credential-endpoint</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <client-capabilities>
            <code>
            </code>
          </client-capabilities>
          <scopes>
            <scope>
              <id>openid_credential</id>
            </scope>
            <scope>
              <id>university_degree</id>
              <claims>address</claims>
              <claims>family_name</claims>
              <claims>given_name</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
          </claims>
          <client-store>
            <config-backed>
              <client>
                <id>wallet</id>
                <secret>$5$LC9YfoAqyqd0P4di$h9F6LgTGIAnm.52QcxhOdcp/5gQIixOPFdpRJdGWF8/</secret>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <scope>openid_credential</scope>
                <scope>university_degree</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <verifiable-credentials>
            <w3c>
              <type>
                <id>https://example.org/examples#UniversityDegree</id>
                <simple-name>UniversityDegree</simple-name>
                <claim>
                  <name>address</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>family_name</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>given_name</name>
                  <mandatory>true</mandatory>
                </claim>
              </type>
            </w3c>
            <verifiable-credential>
              <id>example-credential</id>
              <name>University Degree</name>
              <w3c-vc>
                <context>
                  <id>example</id>
                  <uri>https://www.w3.org/2018/credentials/examples/v1</uri>
                </context>
                <type>https://example.org/examples#UniversityDegree</type>
                <token-issuer>credential_issuer</token-issuer>
                <issuer>
                  <infer-from-kid/>
                </issuer>
                <allowed-subject-did-methods>
                  <all/>
                </allowed-subject-did-methods>
              </w3c-vc>
              <credential-ttl>864000</credential-ttl>
            </verifiable-credential>
            <expose-metadata>
            </expose-metadata>
          </verifiable-credentials>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>credential-endpoint</id>
          <uri>/credential</uri>
          <endpoint-kind>oauth-verifiable-credential</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <custom-token-issuer>
          <id>credential_issuer</id>
          <issuer-type>jwt</issuer-type>
          <purpose-type>verifiable_credential</purpose-type>
          <jwt>
            <include-key-identifier>false</include-key-identifier>
            <include-sha-1-thumbprint>false</include-sha-1-thumbprint>
            <include-x5t-in-jwks>false</include-x5t-in-jwks>
            <algorithm>EdDSA</algorithm>
            <signing-key-id>credential_issuer_key</signing-key-id>
          </jwt>
        </custom-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <crypto>
      <signing-keys>
        <signing-key>
          <id>credential_issuer_key</id>
          <eddsa-curve-name>Ed25519</eddsa-curve-name>
          <keystore>data:application/p12;aes,v:S.VEZ4NEpMMkJzSWVFTm5XUw==.WZMP_OdxR76JqzE5tlPbqw==.ckPzxSK0aBLWhcNv9nr0sJx_vaja6alZH9MhTDVq0GzfLkOfpYFztafXzd4kGCtI8Dys_Lu6nexjccG-bKcoXfD0n-HWYMJ6PndPMD8hbSzqWwLTZ4FS322EBXHNV_I11BE_Gr9_iwWjyhmbXnL3iC-CRKAt63w5OSgeKlcvm67hHcu_Rt1dYH7biqNtspos07R_QUadK5513G-5oQbfDlC_TRw2ih3T1CfY87lbduufG42Jj3M3TKwiaIr9dDmnl5NJ2_lIS9kX-E4rIXPWyqDcnw_g0GFIkKtACmUWGQR03S4LIe49vJrQqPYAbPNgRdZtvQ-nvf9XZ_a6YDYQq4h7GbnQy_Elewat1hU6A-ZbzN9Q7pGPuxdWEmUZTPbQFXEsozeInz1hEHmsXwRTc25N80Ks2ZZG2Ph-3xFD13uv_leKu3KHIcTn1KiKpeRCL8zlops_w4DmVz9k6lCzXgxxgg1qLxzhYHVB7aukBMlAxlbjwPpDaRiA9IHrtgeNzTvAC1kK1IGpdbs0cjs8KpO5T7TOVEVSjScqLAxIF8nf0hLXqShMWeKlPbBhoIQXVp9KL9po07npK_va4rD0i8b65PGXZbVVdbxBLhtF-1egc1ijK5dzd7vbyFYEuckv9flp_EDJO9GxvRFJ1EmlWh0DEqv4eqeKmhvvUyM853SUG6eb8xStPSeUN9uBBxxhWfvMR6n8dNgD-djTp6hnPYVyl7TOnD4G4ObKPVC2nGGoTsyn0hY93fIo3VVmmqw2gxd2VtM6kZ7ka-TXH81i34yjEBmhnvXOrCx3vqTX0I_oRUPDibBRLmHgKHVcv2lklB_q0dK56nC4yHqoZFmxV6Wcy-x5hYVjzloshNw9y93WTbMTJYWyVOoex41SHYFw-p1ZDadzwIDqp1uxAcNllUjEgyTbH0MDANtBVahd3-OqykaKr0Zn5whLuqawGFGkVajx4ni-YE79gc0NlQJm8AX6lKvkc4_5XrPZyWMFuyA5bGdS1ns-D-S1P-AwPxIMgjxFUJMvuIczianl_xn8cXSZImRjYmFwfHzsE8YuaRgGa7F2dxUABiwcaXsrKWKdlOF5C7vjafMhrB71ZUMeveVWaiTvlGlcoL3kTensjk1WhXuFGj0z6URz-CR6-7hHJa4CrRUpqitQhFEfIIKUxnSCh8MolZJ8Agsd2nJWjkGecEY7YIKRq4Lkd7wjCIVCQamWRJhABf9Y_o9Cj6rxkIxCmsCoiLtIzlGM4ToRtAxMjSbH_MkrPSVrkl_uz2-6.iyojA8h7DfeY55_xD7juNqM8Em-mVVxR6oIZ8E4mtXc=</keystore>
          <type>eddsa</type>
          <external-id>did:example:1234xyz#key-1</external-id>
        </signing-key>
      </signing-keys>
    </crypto>
    </facilities>
</config>
