<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <services>
        <service-role>
          <id>default</id>
          <endpoints>credential-endpoint</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <scopes>
            <scope>
              <id>openid_credential</id>
            </scope>
            <scope>
              <id>university_degree</id>
              <claims>address</claims>
              <claims>family_name</claims>
              <claims>given_name</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
          </claims>
          <client-store>
            <config-backed>
              <client>
                <id>wallet</id>
                <secret>$5$LC9YfoAqyqd0P4di$h9F6LgTGIAnm.52QcxhOdcp/5gQIixOPFdpRJdGWF8/</secret>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <scope>openid_credential</scope>
                <scope>university_degree</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <verifiable-credentials>
            <w3c>
              <type>
                <id>https://example.org/examples#UniversityDegree</id>
                <simple-name>UniversityDegree</simple-name>
                <claim>
                  <name>address</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>family_name</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>given_name</name>
                  <mandatory>true</mandatory>
                </claim>
              </type>
            </w3c>
            <verifiable-credential>
              <id>example-credential</id>
              <name>University Degree</name>
              <w3c-vc>
                <context>
                  <id>example</id>
                  <uri>https://www.w3.org/2018/credentials/examples/v1</uri>
                </context>
                <type>https://example.org/examples#UniversityDegree</type>
                <token-issuer>credential_issuer</token-issuer>
                <issuer>
                  <infer-from-kid/>
                </issuer>
                <allowed-subject-did-methods>
                  <all/>
                </allowed-subject-did-methods>
              </w3c-vc>
              <credential-ttl>864000</credential-ttl>
            </verifiable-credential>
            <expose-metadata>
            </expose-metadata>
          </verifiable-credentials>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>credential-endpoint</id>
          <uri>/credential</uri>
          <endpoint-kind>oauth-verifiable-credential</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <custom-token-issuer>
          <id>credential_issuer</id>
          <issuer-type>jwt</issuer-type>
          <purpose-type>verifiable_credential</purpose-type>
          <jwt>
            <include-key-identifier>false</include-key-identifier>
            <include-sha-1-thumbprint>false</include-sha-1-thumbprint>
            <include-x5t-in-jwks>false</include-x5t-in-jwks>
            <algorithm>EdDSA</algorithm>
            <signing-key-id>credential_issuer_key</signing-key-id>
          </jwt>
        </custom-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <crypto>
      <signing-keys>
        <signing-key>
          <id>credential_issuer_key</id>
          <eddsa-curve-name>Ed25519</eddsa-curve-name>
          <keystore>data:application/p12;aes,v:S.VmlTVnZLdXJlZmZTSW5reg==.mNm6cH7E2gFD0T1Ye4jbpg==.Z50IwjsBlRs6JSBQ2sD7pcjtn6EW2hh1DgV3zuJh_PLjp8vSfWYagz2hkhoZE2ZVNsz63avn5K7wH9hlqF4tCj8N2hB151bVnOtnuk7i7d8FyVrr9RPsIu63RxzuliKNfxl9a3zQL9-o7LC7xUCFoiYzlNCpLMz_LzXiLkxYJWZVnyHp8N5PshzMqpSZ8kNAhLPhLtVeyVmtJiW983NhUxAYizDHKW7Sj2xkEd5EBTS7HRsxrfvGzV16v-u_6k9GPM6EYwY3N7wmi5Qsu1xzY4zGXQbd4CsroiGOl-OXWXBvrpP0_MlMLD5ac741iMkRlRCV_ru77vsqvF7HTgNHS6wpA2q6dmQD1nL_vs-O2coUX26EEmdwr5DM2l3TSqsRmLcO6XyNEc9P2nzBWqmf9h5KjR-WT2KwV9EwWunt3agOaXFhXYvwaz744obYRjopIRNX1gWmyvWw9aDnGpWKXR1hE2giBl4qf9ZRT_bLA318DXBXeXCv2NHClz7TM1OTR2_U71TEzCgVF1G6e-YoTeAwftHErrJDf5NXtqKroe4qALCV6wTe1WC2M8fWujRChVUsNMVT9KLHlZ1yKpz2rjm7TTUENfSnggwROA8ggNWWpjUfr3saC2X08_iOPOApvu9U4mT-C6R0RCJZH38xqW8E14mtVn5mwacPKaBF_IS3VimGOisufLk6dxlR5mvIGD_5QVBKU_6JDJqXp0jvmG9h2FoPLzte7rO_QZtKTi1wWFsx8xPhoF_rS-0h7poFNAuiZMGeDTLhoqlzgH8poKNA913x-7Xp9fggM4VDREzRst7tSK59B27oLRvk9dyhs-K9XNCX3-J4nX0zA8D8R_5suyXEkIpXPxTxOF7sz6BzkNUBnWUzAxrYRkGJtK_QgfiUWechX9TUPKIEw-QOFb0MKSE-koyrldt6ddGvszODCHmSjCdVySF6Qxp5dHC6jpvdruYCC4qVbfaWNtJu4hxp8QIa9bSx78bhvDtQ5nf7jp-Fvo5YulIVd19qx8Mi8qgSWsIlBM6m_MnsO7EgDDwiX8UI-mtO98yCTykZFkCxEwpmN4Ric_m1d1uX8auAVy1ngpjAnu0jWzb4EOe0XQm-A-7ID11Xi-A1jIlMWSkYtxEQkYPLKQRW53Sca1ed7VcS-U7nzHzy5LfnFDuPvKxBDgZ02KDeWdBhH-SOGmjojMnVEg2H_kb85uD5TitH6lA0sKsExyKB1h9wtMT2Hg==.mbupF-uSNMhHMmJdEDj-gUcuQggYkd7ELZy5ha1EHG8=</keystore>
          <type>eddsa</type>
          <external-id>did:example:1234xyz#key-1</external-id>
        </signing-key>
      </signing-keys>
    </crypto>
    </facilities>
</config>
