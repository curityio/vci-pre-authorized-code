<config xmlns="http://tail-f.com/ns/config/1.0">
  <environments xmlns="https://curity.se/ns/conf/base">
    <environment>
      <admin-service>
        <http>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <web-ui>
          </web-ui>
          <restconf>
          </restconf>
        </http>
      </admin-service>
      <services>
        <zones>
          <default-zone>
            <symmetric-key>data:text/plain;aes,v:S.R2trU3Q1ZjdLSjJLSWxOYQ==.-urFCesURbaNVBNKsXuzdQ==.HWhXvJLlchbVkNbjo7CtU3D5ucQ08S82_F2pH30Kncbfpyqih75vbphNvKTGD-KvibpEj6P6_8RY1EF93KpI3f6KQftm5xTBXDKrghb8CpI=.-rIplOa2EPkkhekDjgVWT1PGLBx9OyKSFS6yx5wR2yM=</symmetric-key>
          </default-zone>
        </zones>
        <service-role>
          <id>default</id>
          <ssl-server-keystore>default-admin-ssl-key</ssl-server-keystore>
          <webfinger/>
          <endpoints>authentication-service-anonymous</endpoints>
          <endpoints>authentication-service-authentication</endpoints>
          <endpoints>authentication-service-registration</endpoints>
          <endpoints>credential-endpoint</endpoints>
          <endpoints>token-service-anonymous</endpoints>
          <endpoints>token-service-assisted-token</endpoints>
          <endpoints>token-service-authorize</endpoints>
          <endpoints>token-service-introspect</endpoints>
          <endpoints>token-service-revoke</endpoints>
          <endpoints>token-service-session</endpoints>
          <endpoints>token-service-token</endpoints>
          <endpoints>token-service-userinfo</endpoints>
        </service-role>
      </services>
    </environment>
  </environments>
  <profiles xmlns="https://curity.se/ns/conf/base">
    <profile>
      <id>authentication-service</id>
      <type xmlns:auth="https://curity.se/ns/conf/profile/authentication">auth:authentication-service</type>
      <settings>
        <authentication-service xmlns="https://curity.se/ns/conf/profile/authentication">
          <authenticators>
            <authenticator>
              <id>username-password</id>
              <html-form xmlns="https://curity.se/ns/conf/authenticators/html-form">
                <account-manager>default-account-manager</account-manager>
                <credential-manager>default-credential-manager</credential-manager>
              </html-form>
            </authenticator>
          </authenticators>
          <protocols>
            <protocol>
              <id>default-simple-protocol</id>
              <simple-api/>
            </protocol>
          </protocols>
        </authentication-service>
      </settings>
      <endpoints>
        <endpoint>
          <id>authentication-service-anonymous</id>
          <uri>/authn/anonymous</uri>
          <endpoint-kind>auth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-authentication</id>
          <uri>/authn/authentication</uri>
          <endpoint-kind>auth-authentication</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>authentication-service-registration</id>
          <uri>/authn/registration</uri>
          <endpoint-kind>auth-registration</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
    <profile>
      <id>token-service</id>
      <type xmlns:as="https://curity.se/ns/conf/profile/oauth">as:oauth-service</type>
      <expose-detailed-error-messages/>
      <settings>
        <authorization-server xmlns="https://curity.se/ns/conf/profile/oauth">
          <authentication-service>
            <authentication-profile>authentication-service</authentication-profile>
          </authentication-service>
          <client-capabilities>
            <code>
            </code>
            <implicit/>
            <resource-owner-password-credentials>
              <credential-manager>default-credential-manager</credential-manager>
            </resource-owner-password-credentials>
            <client-credentials/>
            <introspection/>
            <token-exchange/>
            <assisted-token>
            </assisted-token>
          </client-capabilities>
          <scopes>
            <scope>
              <id>address</id>
              <description>OpenId Connect address scope</description>
              <claims>address</claims>
            </scope>
            <scope>
              <id>email</id>
              <description>OpenId Connect email scope</description>
              <claims>email</claims>
              <claims>email_verified</claims>
            </scope>
            <scope>
              <id>openid</id>
              <description>Standard OpenID Connect scope</description>
            </scope>
            <scope>
              <id>openid_credential</id>
            </scope>
            <scope>
              <id>phone</id>
              <description>OpenId Connect phone scope</description>
              <claims>phone_number</claims>
              <claims>phone_number_verified</claims>
            </scope>
            <scope>
              <id>profile</id>
              <description>OpenId Connect profile scope</description>
              <claims>birthdate</claims>
              <claims>family_name</claims>
              <claims>gender</claims>
              <claims>given_name</claims>
              <claims>locale</claims>
              <claims>middle_name</claims>
              <claims>name</claims>
              <claims>nickname</claims>
              <claims>picture</claims>
              <claims>preferred_username</claims>
              <claims>profile</claims>
              <claims>updated_at</claims>
              <claims>website</claims>
              <claims>zoneinfo</claims>
            </scope>
            <scope>
              <id>university_degree</id>
              <claims>address</claims>
              <claims>family_name</claims>
              <claims>given_name</claims>
            </scope>
          </scopes>
          <claims>
            <claim>
              <name>address</name>
              <description>OpenID Connect address claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>birthdate</name>
              <description>OpenID Connect birthdate claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email</name>
              <description>OpenID Connect email claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>email_verified</name>
              <description>OpenID Connect email_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>family_name</name>
              <description>OpenID Connect family_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>gender</name>
              <description>OpenID Connect gender claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>given_name</name>
              <description>OpenID Connect given_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>locale</name>
              <description>OpenID Connect locale claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>middle_name</name>
              <description>OpenID Connect middle_name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>name</name>
              <description>OpenID Connect name claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>nickname</name>
              <description>OpenID Connect nickname claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number</name>
              <description>OpenID Connect phone_number claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>phone_number_verified</name>
              <description>OpenID Connect phone_number_verified claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>picture</name>
              <description>OpenID Connect picture claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>preferred_username</name>
              <description>OpenID Connect preferred_username claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>profile</name>
              <description>OpenID Connect profile claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>updated_at</name>
              <description>OpenID Connect updated_at claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>website</name>
              <description>OpenID Connect website claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claim>
              <name>zoneinfo</name>
              <description>OpenID Connect zoneinfo claim</description>
              <value-provided-by>account-manager-claims-provider</value-provided-by>
            </claim>
            <claims-value-provider>
              <id>account-manager-claims-provider</id>
              <account-manager-claims-provider xmlns="https://curity.se/ns/ext-conf/account-manager-claims-provider">
                <account-manager>
                  <id>default-account-manager</id>
                </account-manager>
              </account-manager-claims-provider>
            </claims-value-provider>
            <claims-mappers>
              <claims-mapper>
                <id>default</id>
                <id_token>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </id_token>
                <userinfo>
                  <claim>address</claim>
                  <claim>birthdate</claim>
                  <claim>email</claim>
                  <claim>email_verified</claim>
                  <claim>family_name</claim>
                  <claim>gender</claim>
                  <claim>given_name</claim>
                  <claim>locale</claim>
                  <claim>middle_name</claim>
                  <claim>name</claim>
                  <claim>nickname</claim>
                  <claim>phone_number</claim>
                  <claim>phone_number_verified</claim>
                  <claim>picture</claim>
                  <claim>preferred_username</claim>
                  <claim>profile</claim>
                  <claim>updated_at</claim>
                  <claim>website</claim>
                  <claim>zoneinfo</claim>
                </userinfo>
              </claims-mapper>
              <default-claims-mapper>default</default-claims-mapper>
            </claims-mappers>
          </claims>
          <openid-connect>
            <expose-metadata>
              <token-endpoint>
                <endpoint>token-service-token</endpoint>
              </token-endpoint>
            </expose-metadata>
          </openid-connect>
          <client-store>
            <config-backed>
              <client>
                <id>university-website</id>
                <secret>$5$I/8/uo9uncEvH9i.$cHI516ERLxMToQlb1B/V9yQ9CwjIzNS24PfhBomfps8</secret>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                  <token-exchange/>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
              <client>
                <id>wallet</id>
                <secret>$5$LC9YfoAqyqd0P4di$h9F6LgTGIAnm.52QcxhOdcp/5gQIixOPFdpRJdGWF8/</secret>
                <redirect-uris>oauth.tools://app/callback/code</redirect-uris>
                <redirect-uris>https://oauth.tools/callback/code</redirect-uris>
                <scope>openid_credential</scope>
                <scope>university_degree</scope>
                <user-authentication>
                </user-authentication>
                <capabilities>
                  <code>
                  </code>
                </capabilities>
                <validate-port-on-loopback-interfaces>true</validate-port-on-loopback-interfaces>
              </client>
            </config-backed>
          </client-store>
          <verifiable-credentials>
            <w3c>
              <type>
                <id>https://example.org/examples#UniversityDegree</id>
                <simple-name>UniversityDegree</simple-name>
                <claim>
                  <name>address</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>family_name</name>
                  <mandatory>true</mandatory>
                </claim>
                <claim>
                  <name>given_name</name>
                  <mandatory>true</mandatory>
                </claim>
              </type>
            </w3c>
            <verifiable-credential>
              <id>example-credential</id>
              <name>University Degree</name>
              <w3c-vc>
                <context>
                  <id>example</id>
                  <uri>https://www.w3.org/2018/credentials/examples/v1</uri>
                </context>
                <type>https://example.org/examples#UniversityDegree</type>
                <token-issuer>credential_issuer</token-issuer>
                <issuer>
                  <infer-from-kid/>
                </issuer>
                <allowed-subject-did-methods>
                  <all/>
                </allowed-subject-did-methods>
              </w3c-vc>
              <credential-ttl>864000</credential-ttl>
            </verifiable-credential>
            <expose-metadata>
            </expose-metadata>
          </verifiable-credentials>
        </authorization-server>
      </settings>
      <endpoints>
        <endpoint>
          <id>credential-endpoint</id>
          <uri>/credential</uri>
          <endpoint-kind>oauth-verifiable-credential</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-anonymous</id>
          <uri>/oauth/v2/oauth-anonymous</uri>
          <endpoint-kind>oauth-anonymous</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-assisted-token</id>
          <uri>/oauth/v2/oauth-assisted-token</uri>
          <endpoint-kind>oauth-assisted-token</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-authorize</id>
          <uri>/oauth/v2/oauth-authorize</uri>
          <endpoint-kind>oauth-authorize</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-introspect</id>
          <uri>/oauth/v2/oauth-introspect</uri>
          <endpoint-kind>oauth-introspect</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-revoke</id>
          <uri>/oauth/v2/oauth-revoke</uri>
          <endpoint-kind>oauth-revoke</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-session</id>
          <uri>/oauth/v2/oauth-session</uri>
          <endpoint-kind>oauth-session</endpoint-kind>
        </endpoint>
        <endpoint>
          <id>token-service-token</id>
          <uri>/oauth/v2/oauth-token</uri>
          <endpoint-kind>oauth-token</endpoint-kind>
          <token-endpoint-procedures>
            <flow>oauth-token-token-exchange</flow>
            <procedure>pre-authorized-code</procedure>
          </token-endpoint-procedures>
        </endpoint>
        <endpoint>
          <id>token-service-userinfo</id>
          <uri>/oauth/v2/oauth-userinfo</uri>
          <endpoint-kind>oauth-userinfo</endpoint-kind>
        </endpoint>
      </endpoints>
      <token-issuers>
        <custom-token-issuer>
          <id>credential_issuer</id>
          <issuer-type>jwt</issuer-type>
          <purpose-type>verifiable_credential</purpose-type>
          <jwt>
            <include-key-identifier>false</include-key-identifier>
            <include-sha-1-thumbprint>false</include-sha-1-thumbprint>
            <include-x5t-in-jwks>false</include-x5t-in-jwks>
            <algorithm>EdDSA</algorithm>
            <signing-key-id>credential_issuer_key</signing-key-id>
          </jwt>
        </custom-token-issuer>
        <default-token-issuer>
          <jwt-issuer-settings>
            <signing-key-id>default-signing-key</signing-key-id>
          </jwt-issuer-settings>
          <default-data-source>default-datasource</default-data-source>
        </default-token-issuer>
      </token-issuers>
    </profile>
  </profiles>
  <facilities xmlns="https://curity.se/ns/conf/base">
    <data-sources>
      <data-source>
        <id>default-datasource</id>
        <jdbc xmlns="https://curity.se/ns/ext-conf/jdbc">
          <connection-string>data:text/plain;aes,v:S.alRRdkhsVTNxNzBuZUVuMA==.gBAV0r0T_Xz44ONiwYTN5Q==.ynSUFGEnRJQPj5vSmBRiWTut6dvM5sJ_JEHbUHDHzzn48eu_NVPoBhdfC9mKYUNtDrT7BnfRhWRnWuSWpTIYCNUsq3KkHMJgit6iLJzjtRNzp9SD9PbP7PxKKJdgptP1.QfzEF70a-XXYOFlYXiHrIqXOcd7UmyLjTR1IW0BD_fg=</connection-string>
          <driver>org.hsqldb.jdbc.JDBCDriver</driver>
          <password>data:text/plain;aes,v:S.MVRlc1lmcGNTWWowR1NLTA==.Yx9rF09IJQlusNxKFSZn1Q==.CJKdP2_yt1G-sdpqYRHf6w==.Z1jy6dR_qknsYCG0dpz0vMbRzpoPX4pJ4AWQhytPHN4=</password>
          <username>SA</username>
        </jdbc>
      </data-source>
    </data-sources>
    <crypto>
      <ssl>
        <server-keystore>
          <id>default-admin-ssl-key</id>
          <keystore>data:application/p12;aes,v:S.RFdxVU1GVUg5cWVQMXVIZA==.Dklv2e9cn2RJ9NBVUdF5iA==.cWgiRVEqn-hV8J4UQO7Bq2DnE6Cn9o9QAptOmmjnQm1YTZkk7GqyUIIOWMtzqbHdBfja3vQfcJ7tuqlcdqMta4Jb8Bc0RWRPw2ZEe7T2I0sA-1UQPK_yXANBCGHjx_BAru8v3KwJRPgGAQJREP6ZvjSngAVArGXtpk_ZuDsQ1wJvqWz8Xk82KwHns2JgOuO-DZRcFm4cYFmtitJsFhGne_erU6NqVNWxDuc8-D3wtAT6l9MY5S9FD6eR8CduC8nDd4H6MsddKho-e6EGpEd8P5HkB6mWI-tIlAf3ep7jd6aH7PaC_KsupTg3RPS38hNZxpeyOjABNl_TcYLnkcaw9eybn565k8HbrLam-ce3VqbAJN7IV7zwaOtCvP2aFo6mGIdO66OljFbjdxIZo1VJQxK8WB61CwTj3HRrBDWH0iw61MGHRxGbj9y4unXonM4hWtGqKsBtTuSo6oGmuQRlfjnsZDT-XzvfCu942SeMaJ-uOkghYVmB4Y7DGn4ASneYUQ3J_qwvGNVLtU1ZBnV_oA98T2pUUzH_zp9q5pSBDqSju_-hm_V1GpozF7qwvybnvFPIi7ohRBXgX5olemUzmyP21aYXflkS6VTdrlKZx4vUh81Key8YYGho2tXsUzn0Bplami7q9bU6mQZyaWcrvXDk065bdFlfXFWB_vVvNRl2t5dfDuTmC8DjE2dX9uOR0jRNhE8aNExBU_dJ60WFEuuDvSv7l6OuAQgAc5O181gP3KLPiouOzjmqKnlM8tu7jfQ1cxuUQK6rdNJeZk-rTXpIZ_pvFmoz90tKnu0LQWIfaYmJbweaEfBuRP7dWmpc1OpDxAvqNSEKcx6hWxDQFMKcGux_kAFuMPW_nl4dToj-SgaaKGDisKW3AGEW2WpL1snKReDB2tYCJNA9FJlMpyydKFJBuNcFpLMloy9LR3-PqGwtJuva6ZVEXUqBk0b047Ntx0px9eXrkMFiW8Ozp0UM0uEXLabXWS2UssE7RagPvMLq91uUjx2HKeqaEe848F3BibSeGwtAQJhloDH8A0PPpoEmYrEoluPePNl65TMACjXJwI1IHI3FOMewI4MYOFEXDTQgWwbQ7Icz_vB63LosjB6vjr0Hosz7oIAW4nPije6x1D9WlZ2wo7mw--9_FngsOZWcdYK9jbSTOcjio57AWTYA7jMcoLoAgH05ZuazulPu4DhfBdBv6ccTB82zn1CbRa5W8QO5ZJPtciJQ5nmNcB8HxdX9zl9Gp-5BrxNKpdxrv0ttrcsLtiu6p1uZQvAmyT_VGvZ4QT74vNAqWq2ARzmSBj1ZqPKVmQq6rRDcH3E6GpsMzjbfcW6qOvlPa8h1L5bOfZ-q9bmX9BCnSQktF46JkyIPZfSWxETtCyHVJzL8G6ADbbnR6hcvkcXK6VmPN8zhMHVDmnfmSGKpzxv1i_x56k4rnnyQ-d2vWYXxZ6SO9C61zc00xT1iAMCP3-COhQfotZ-PbEiQixJETGGJUthaZgJld25PV8brxymXpnFWSUX-OcH9FIRp78WM36ae850si0ghyS5iX-df69ogJyrLQYrlkyha_ExnzoI1aZI3JHnErqrsns7auJTos6XNgCysGY7_zGItjsgwffLP7QPewEoi3_SwFsUSUdtwuNvuiBTMj-XhiklyQCqmuKvE8W1AEO8JYYgJp9D6CniJVXbAEcb46ICdccWLVGVvmBvE-tdb_d5ueYOwOeM0m8ZS_TVkr-B4fcTdHzsCjS4hOnrdEe316uQmx3vyFLISwFaEycBdpXTT_3VZZcrNf-WbhL80Z1dUgr0dVoZ5Dnj7_6ue0AirAeDIQTnE69L66DglZFF3elthKvDmXvMNE_P4j_yNTHMaGF4qdO6uiHFvcHObd7UOTniuH_hEumXolRRuClxgB-fDPR_lwjA-C8_jdiXrAC-3nIx2SqqG2189i6cZ94obrkGDV2hL9Mw81YKT5xS7OjNmoPqeUz3EifMElp6oO97I_tGTFyos0l_2PxKWEBxtEi3J78ckk2lzV2kcy3bm1aG2EDmFquDKh6N89u-6VsDXsNOmLRMZWjQ3JMdilMbxi5AYmHCpfqOH-aZgGSBmjzHI-PXsOaASXRZG6sqF7TeNuQF_-CL-p-h_4TmNaAKcQiLIFvT-qG3Siq5fRZUvlQ-aABHIiiBd9X_8lsYXGKjAm5NntUuC06fHtsnH1w7CqxZFhuJqbYSRwyMr7gbyMbldbeou4gKlOochC4hRlYf87LY2GdDWD2BtpUd2Q-xpg6HzSYWVEV6u5RJqIGXa7pMZpIQMX8LItQow9mks8uhWgQdinikRc38ooTSZdcZaFNjoasLuFNwuHq9Qx2I34QgxSBdOQv3dWl76G9nENiGeM50DKI7JplzpznYH0V0dN0bK7Na1k63Z8UgcmDxHaMCKDk9SP2R78PGpBatmi2cbY13cyVkpioJKF_1A_Bz4kkMyu76uI5adLOgcDM9oNSQL0dlXMkRnOnDnlypIloKsc9Y-f8Bx5oxQjBOefxZ80ODGpydCjDdQWZXxVvoZ0JgxjDlQILlNPOzX9vFNsf1gWr59A4-4XJzahqG5MKg21alRNp88s_T88kItNqbYy5fQmoxHP40gYWjrS-JTIMwrhwyOqQ_WX2aD-f8BT1TX8kr_FoUC05PoE3GwXnBQ2vjz-Mbib4LvNBJtI7niXBk-FwhH-stiP4DFYPRLFVAc4jiJ7CZR2w5T1sDJq0ddQX2VPI9pr1t2kai5o69PxDW5lXZOpC-ZiOAuK2p8qgnNFV9I3VcG-YxNsD0VznhEQAkySLDiJGlmGs-f4xdN08XKHuMc-SUXBF-Qnn7o5llG9g_kjBZh06zFlctY-L0ZAKXOIsh_bVnSWS29PeCYpcuHmejPIw4Kft4QsHI7N-MYWYIRBcZAxlj72Z-yOEqC7SV2RYN7_HzPitg98qeTBGfITVkOMqccjaBwqtgiwpDvnEjyiuMwIRVJ_123cFnTBbwjZxXUzLbJAPMzAMEL5l4WXPxzt-ZSsI3-T2yv9mF7mN1wwcF5d1Qrkua_T0d73PIWvZ1BdJH-LmyOew48UjFZVnEATtEnuViwH5uBjlKC1FEV86jOJMoIqRgiYtWVfi8QVMZoOZlme53MyogaFikU25wEuGoLCZrMVRvZChQY6lPgs7ESIkkPrCQy1t2Y998WKhnCl_odGgp2gt1nid2op59vhDQsFg52avjs_1kEjoHmidyJWL-CXRrGOFS7d42AHDv02iu6AFDJNwckGYdoRUpVp67sUuczoZvtBJrqGwy3VO5izY-B4NNBUWjk5yRtGVUuuz-FstwyopZFfhV9RTfuQJbqkdPwdxVim5s9HWMhG9OddwBTrs9zXSV6XD7haihJRULuceMYwWXQPEJNA5Hcvc7FKCOs8pTw1PaCBrsNJVuefPY_2eF7-8D26MqatIQ2_pz8BbIf0Akjek0QAu7rdm_CDIWEOidD8QHZJWtsEK8rSGe0f8OvpngpKJD1NuCkM1UcaHccoug2Du8q4ZF23wj2Uu2Cxd4PgUfQi5tHR5e7emrYhw6JrykgQ0PMhUQZKi4IyT0JJwnPaQRxZR6lVADpbwy3KDVENoKFaDfx9bvyoagANVL06rbKJX4sn3pK9P_4.T4ybuU-VqxJbXZ_l_ihgCqqkQQOchRWDOpyLPJTA3hQ=</keystore>
        </server-keystore>
      </ssl>
      <signing-keys>
        <signing-key>
          <id>credential_issuer_key</id>
          <eddsa-curve-name>Ed25519</eddsa-curve-name>
          <keystore>data:application/p12;aes,v:S.VEZ4NEpMMkJzSWVFTm5XUw==.WZMP_OdxR76JqzE5tlPbqw==.ckPzxSK0aBLWhcNv9nr0sJx_vaja6alZH9MhTDVq0GzfLkOfpYFztafXzd4kGCtI8Dys_Lu6nexjccG-bKcoXfD0n-HWYMJ6PndPMD8hbSzqWwLTZ4FS322EBXHNV_I11BE_Gr9_iwWjyhmbXnL3iC-CRKAt63w5OSgeKlcvm67hHcu_Rt1dYH7biqNtspos07R_QUadK5513G-5oQbfDlC_TRw2ih3T1CfY87lbduufG42Jj3M3TKwiaIr9dDmnl5NJ2_lIS9kX-E4rIXPWyqDcnw_g0GFIkKtACmUWGQR03S4LIe49vJrQqPYAbPNgRdZtvQ-nvf9XZ_a6YDYQq4h7GbnQy_Elewat1hU6A-ZbzN9Q7pGPuxdWEmUZTPbQFXEsozeInz1hEHmsXwRTc25N80Ks2ZZG2Ph-3xFD13uv_leKu3KHIcTn1KiKpeRCL8zlops_w4DmVz9k6lCzXgxxgg1qLxzhYHVB7aukBMlAxlbjwPpDaRiA9IHrtgeNzTvAC1kK1IGpdbs0cjs8KpO5T7TOVEVSjScqLAxIF8nf0hLXqShMWeKlPbBhoIQXVp9KL9po07npK_va4rD0i8b65PGXZbVVdbxBLhtF-1egc1ijK5dzd7vbyFYEuckv9flp_EDJO9GxvRFJ1EmlWh0DEqv4eqeKmhvvUyM853SUG6eb8xStPSeUN9uBBxxhWfvMR6n8dNgD-djTp6hnPYVyl7TOnD4G4ObKPVC2nGGoTsyn0hY93fIo3VVmmqw2gxd2VtM6kZ7ka-TXH81i34yjEBmhnvXOrCx3vqTX0I_oRUPDibBRLmHgKHVcv2lklB_q0dK56nC4yHqoZFmxV6Wcy-x5hYVjzloshNw9y93WTbMTJYWyVOoex41SHYFw-p1ZDadzwIDqp1uxAcNllUjEgyTbH0MDANtBVahd3-OqykaKr0Zn5whLuqawGFGkVajx4ni-YE79gc0NlQJm8AX6lKvkc4_5XrPZyWMFuyA5bGdS1ns-D-S1P-AwPxIMgjxFUJMvuIczianl_xn8cXSZImRjYmFwfHzsE8YuaRgGa7F2dxUABiwcaXsrKWKdlOF5C7vjafMhrB71ZUMeveVWaiTvlGlcoL3kTensjk1WhXuFGj0z6URz-CR6-7hHJa4CrRUpqitQhFEfIIKUxnSCh8MolZJ8Agsd2nJWjkGecEY7YIKRq4Lkd7wjCIVCQamWRJhABf9Y_o9Cj6rxkIxCmsCoiLtIzlGM4ToRtAxMjSbH_MkrPSVrkl_uz2-6.iyojA8h7DfeY55_xD7juNqM8Em-mVVxR6oIZ8E4mtXc=</keystore>
          <type>eddsa</type>
          <external-id>did:example:1234xyz#key-1</external-id>
        </signing-key>
        <signing-key>
          <id>default-signing-key</id>
          <keystore>data:application/p12;aes,v:S.QnhMNjNHOFdNVlluM3NYTA==.JVtZToZBOAlI2V-bQbbs-A==.EMRR__YqRVFgg9yCVnhk3sbBuw4nWHynuA6btsyFUBxeNdRDXgIrc57-Q7UsTeLnAKAs7C0dMYIsJTTi0jXHzYjxAjksvbCUsRKken8O8KZa-Jyzm-rDRYdOlCHmwOomzjTVHqyONYCGddN8ecG_QOVhu_cxY1VetmAopYiupfBTcV3YsA7mIoYVLWBNNlM6BveujYVlwG8i7sJi9bD2gSj0GjTLnOpNk-4h4KXCZUjwyarKM1GuMRcXBzVkXNKizWorjG-QnYtGh7791LzihqwMwXtREDIkmyi9e-aqxv9Y6oCYiPmPiO62e9UEYoFWp-UOSC-2DXlfFHSSU8vxBY71DL2mREtKHcbluwbbiWn_8bVrBK4LOvLhkl5wCPpZs_OeRjgz2h6t9tnqwFcu8bQaOsFRXnMViYKFng_0ijPjDGgGcvznrCX428jMsFhKFJzVNO2jK1zVWKJVR5Uuxm30ZUBnW1VisJ__YMO_jBPyLlv4APdFAzFDVeRrPPBmi2F-iOe28p24A5io3F_HFBM0dL5BXk57toifiLnmkMpNOZv2cceGt7TqMFgN_BR-0vOa-04IURUyoxD4LqE-DRewVDZbflx2GftyLAWYUvMKOl5jkUzyauGxbe_WPiSoXYWLhMALcWWkh7_U5emEidOkVZPen6xFOw8T0dVVYdOO-MBE2MseZs494PywII_Tk6Bme5tgo8QmU4uPUEY55XYHmDPSWR36bDhH0e6_XkEtnkPpjtcHVtKZ7QE1msXFOJA2d6hrkxfsLvuS-nCXOcUFxtLaGoHpTb2OhlTcBEzXjYbleNypjaIAd43AXAG6z3YmGAEAvz3zT2VZXA6tu1fGMcyn3O8sa1bQvisIlvI4fLEllec--Oc6sDAekJiPBg6R5iu_6gCUFGRALjCyLfbll_ESoje0DSnNinmRj45zUXlXRaWwegeB4p4VLYDEDmt8-5VQ9nKX_8fXJDSLeyWuurVAOkvODifYFsZfXCiwSSCAn3QRkkQ7ngSd2R9uGJ-EBNN4LPGg-8-o2jo4C5KB9OpWXaITiZhVN4kP4Do2VqA0E8KKAxDgJrUQ1WP4t1YIxZw37KIyXQ3sUV7d2iKyUw_4BLa7tcvrLXKAXwOukXQImvxbSce_dvGGvf_Ke5D7Bmx9nPSpy2B4UQ3geEZfgYczggUw8wHZeTaWmYz6OJSm9NU6URUawUzN9lIPQfRpszKypS2e8wz6ffW8TUpqIvI2d5XMQ2quUBo0HlVSSGQ6x7VHngU-gxXhgAzti824stHGO5bJaKAOoUuQZuPu7v2hD_jLUmpMEHvE99F7pq21SljfzmkUcnwzfaVzQINFU1EF_iH8Rrvprm_HEwC7BAuD-bmSoump1aWLUpL7pnYCqnG3mNyBGsEngP6Q9yDxAHiQJdU6RMO-J9ZT1WWIxNGkDDne5qhc6IsKQF_pE33ln6I7SNf36ZJZY0pZ4fCUgui_F57wGE9J4VK0AfYnbCUu3uSQczABg_-j4k-zxzEiGkCRwJ8A7DYzE-cKgWhqK7DsGhrdP9n0_RGRauU15S1T24vU1uboWQAnu_dd1NQWsq_4ZgO6Pl4kFn-4RaCabbtdwXoWvyNKVHMbRZZuMBczDU6hlxt3PNc-CRUi1Kp9uDh6WtpYHNINX5FIbqhQwnoeykootqOLn-Ftg_MkD_-9NlW2swk-dZbabMlFVuJNYp93VsWDAQA4O1jbE-6VCF4_ttyIkwnyVsV21mdzOrOtzmb4BldbpAnQvOyPFryZa45W_kslp7TEKcmj8jFDVgLWvzyu0jLzEwtKCmO8OPOcYnYE_tgQIxlJlzz6NNCMFV0RzBU-OfV_xxK1tYuLusugzY4zGekE_r2nvTCcJaIO7NblxE6-DniCKzmJhicNuqp2jd1hkScfTqd2bdRFnWfv28NRsTzP2aH-V4PkKoCLpyM58XlbFuSmhh8V5l8T6ZmZSD94sbSh3WYQtYHdyPTiQ_8QhfrLgF9fEXyY1MpW6LFRUvVgU5qaUG2onl3RLDbhrebhQXczMfhUM4hrI0OBPO3wKsJRkrXL9I7jq6FfoKgVHj1fcG0y1zHISE1aoNXvZFqiJSp90yLv_RbYGlbjqqnX5MO4HOsEq2aU5_wEzkeGD5InmqoKqlNrnPTLUHqDnG6u63yziBX9bUGbObH9i2qBR6B0pcwo3qSfjbGxIRmpxq8HFRXrSZPYRJlr70tGubyiNzuT9bgxdvVD6kOEotCrPK9k9FZUr7i_HlOePTg3COyhKzKqsr_s3LfhOvw4UbnuCKPeemJokSNP5EB3B32VlEnHUPh1yvvoxzgVSrikAvENUFZleFF_Kj6EX4DX5UBrO8j8x3FxbHAZ0_2rhBF50vgC2Zcy-1TwEX0K5Om5RjHVAIsx31qNy6H0q1PiLuM4U5-haVH1LJ3HCrGZxw29iMURHbWzJr4-1OPESXSfztInlrt4132YzBE3EXOInBYsLjVdn_KlsaynXsCJRoygEzm41EiJ2JFeg0gC2DGarA27cKi9b6Idp7bV4UF2JF9Z4kYLJmgtmZfVXqY9Lt003Kl0OlPHc11U3YAgxItvzEAbUyZcUOoDZhVBiBPrd-ZeT9Ea8VRuEOkY0OLia1whSolol3-ICGTj8wshhY_-IVFsh0Y5AcAsvrqtbMbWD3CWeGPPLHCYLrDTQ0FtiDQ5qaNujERKMhWYxdkm3gtK3aJUdufdCHokxzJ3PkZPvTCVmF_TRjd82apG6qMZICJcDlTpn5xgGDgTAsa_FzON6KjTlIlrbNRlkQcWUSyKfLsoovPc7kNzsoh5yBIE61v_-aUtnH0ONySZkVPrum2WTn66_nNJ_mpFqYRWRPlSqs_ZUDgrNCVqmR1Lt9nRXUZis2GGUuK9hhZvTtKB2ww4k831SDWiSHDqdlJiAj9mx5maRzVfX0HFZ51yl-coJkHhDr_DSrzlg2cDXMtccTc0B6htAXAO13Dg4rSjuqh5RUROIlrmWrhxamqmavLALa5r_hdRNpMx1owFbIQzPAzXTKegb3eQax3KyFyjI39qufGBeSreyrp5Hu823oPEa76T4fy3BU4hxb78poRu_mWFud7sN1iiESXL73zp_rj8srzH_ETpr2K-K29h9cYsWyDIHDXZ8XYhO4UtD0ZdOKHDNHEPk78XGd81XIsVuKy17m8telS5uatlgGEsB4a9pKkW9Cg9gMLH25jWMPq8Dt2A7uBUnGht27WG_Gji_a5OSAtm5e8LqlQMuuhfB6GvnzpeQbzijqitpHvVjS9GqUeKOcSQathffcmIkwjj7uqgJ8p1Ia-6u-KRdG3ZLf8_0Ld6kdGYldlIvHPCKzLwa2VyOeqO149Y3_j5xj0cf43xMRnjzLETZ-9Z1HZfIhUAV7_sWV66F_nGSN9h5nNgQygAlPHr1YoWfL77o6cwTT70M47qoKMxOdbykx4cwfY7--btqRH_cSopiFxJM7X4hwKlO1-c1v3VDAKu9Siqvc2LJi1A5At3UFnLWeCz85xdlTg35KQqg5f5y2UfoFh2cBGtZwztxtQs32uLAR9UPckeX8kbK04L8NdHs_LxF8etG1yFH2G_tLwjVJ1t6Xzph_1DbiDM3Wnz1lH5cV-1fezIhsmKcSTRQFkq.m3KibXPOz_WToMUoppKhVdw8dxQ09kCZ3mC-_dqKMYs=</keystore>
        </signing-key>
      </signing-keys>
      <signature-verification-keys>
        <signature-verification-key>
          <id>default-signature-verification-key</id>
          <keystore>data:application/pem;aes,v:S.UmVqNE9Ua0lYMkZ1SkNFRA==.mCD2NbHqBFDM5_4lyq3cVg==.M-Fg9y9Hn8sU7VK3Ebwj1PNIgZro5y3iKriwqWqSbqKqcNVizqTG3qGWKo_IcyAOcbKBw90UxD7alsiecnGWbgYaZCvzgpykPGhBkSStFy_Jlr0PoCqSCKA0XtfITTERlUH59F6wJLtlHhntt9ndC0hFaXRVJZ5P65nnZz8SuXib21Tk0HzjTOpls_DyfGeNWX7uWgFWhV4vYbwBTpcikeM3VbKBDjEZjutPw4xdPp4ose4zz-7F2XCqyNFP2zS_QK75sXcpA-oGoHKCNa0wN9fWa13ZXrRN3RBQ-MJOEZm6ZoDvxl9gFzglOg_AznAHaATbPZFKlzo0Csa7dAy78CEXeIsrcvXozbQ0riPDzSTPzHbLAuRBYMCxetcwVtVmnnMPlCR2V74EQPzaM1bhv05O_gHlw-WLtc56jWrLDlNTPUM97VovN0lZbf6S-OxVylwNHDJdO3R6IOs4M4R6wfzaXvye4rXQEaaFwEy15h0gckXLiBKoRahnHv5UXx7A0g822DBfsQHZ3uPWSLQaaLIdFzVbqXGOAMNRKmFZm0V11miRUCj_Ytg5523uX60Dn_ENmK_XzyQPvjEQEsHe9Kv0Vg6vdDoay7fpz1-kRronGDRNHy4tF3NTf_aqiYt_eSlBDPfUE8zgm4QaDy4RwYk3sxy-V874LmTatcACp6MTsOOxMx-MZZfj9cM3EkWzp6LRz_3DaU8Qr-q3yX1_9NSutptLYJE8OH1qBo2iR_pF8jLV_WTyH7t_VF90uwTbRco99X03NyFVbGcuUlErvTWmG9yIlswcNxEXROpYmuFKWk4EfCvrRUGaRkbxhjgks8ORnRYvKzj6eQ6vVFzbvNoaTLqMD0bIfWkrMpOpOdaHNSb2HugxtQAtpvSAd_eG2XltU52Tf5eJ56YA316snATTiKpq0aPQko2i7YksuY9wtMe0xz6Lv6oYt85RV4s1_2Urwgy9HqZcY3mSgz-u1S1WeR799Gb7RUUdFDVlCdm6UX0VW9KmOE1Dvn0ynGK_5nilt3WRzPZ4nqomNDFU3GY-kh9y6X7xmat_3bG4SfSz58TSPis1cUxGBiPsbaEQTgSSHjets31UuY9nvXUxUBES7Z0NF1_oSV4XEQrdL639rk7ng2hh0EIUAEWOJOj6t34L9lHSddBm2LjmQ_DIryWHY0PGigKa2fQK0lSskKAtO3O3WQBCO2nyJitMCOWeQOmwyaZsQKinzPr3MrxeBiFlaLQI9MhYAfnH4tA185oDSsjVWDVMkjdORg15P7mtoiQx7ekz_rjMQoiL8bY7SX03pQF09OOKG6S05-vvkXoDsq7DX09R14YBI57nafISXRfAvsMHzRLg4yffGXva2dOAYTd_snmP72g7fpjnk8PqKQ0HHOTIoViNjnjehFnvb4DpZearZme_EuF36Ptnzwxmyn0HNtVgU2ID703gA8KnS0XuVhciaFV6ZycNbGyZ2ICzJ1Rnkk7EE9om-2V1KTuNOI6nxDQqbV5Rx2WpDt6MM3yGqptRIavMOEeSoozBebnAx9DLy2YhCwMNyz1DwvR82f-C3SA6naxHAWZIf3mSvXOWM4fywT5g_WNvaTxIifJWLaHFlvetmEgbsaVEou3_pJj-_TGRRPddNkCkt06axWVgn7lrO71_2TnJHRzR.UDCsvXIJ89KOlM1Rha-aPgIR8qc8nE20ojNHoMBg0u0=</keystore>
        </signature-verification-key>
      </signature-verification-keys>
    </crypto>
    <caching-services>
      <default-caching-service>
        <data-source>default-datasource</data-source>
      </default-caching-service>
    </caching-services>
  </facilities>
  <processing xmlns="https://curity.se/ns/conf/base">
    <license-key></license-key>
    <procedures>
      <token-procedure>
        <id>pre-authorized-code</id>
        <flow>oauth-token-token-exchange</flow>
        <script>LyoqCiAqIEBwYXJhbSB7c2UuY3VyaXR5LmlkZW50aXR5c2VydmVyLnByb2NlZHVyZXMuY29udGV4dC5Ub2tlbkV4Y2hhbmdlUHJvY2VkdXJlQ29udGV4dH0gY29udGV4dAogKi8KZnVuY3Rpb24gcmVzdWx0KGNvbnRleHQpIHsKICAgICAgLy8gR2V0IHRoZSBkZWZhdWx0IGRhdGEgdG8gYmUgYXNzb2NpYXRlZCB0byB0aGUgcHJlLWF1dGhvcml6ZWQgY29kZQogICAgICB2YXIgcHJlQXV0aG9yaXplQ29kZURhdGEgPSBjb250ZXh0LmdldERlZmF1bHRQcmVBdXRob3JpemVkQ29kZURhdGEoKQogICAgICBwcmVBdXRob3JpemVDb2RlRGF0YS5zY29wZSA9ICJ1bml2ZXJzaXR5X2RlZ3JlZSBvcGVuaWRfY3JlZGVudGlhbCIKCiAgICAgIC8vIENoYW5nZSBpdHMgZXhwaXJhdGlvbiB0byBiZSAxMCBtaW51dGVzCiAgICAgIHByZUF1dGhvcml6ZUNvZGVEYXRhLmV4cGlyZXMgPSBwcmVBdXRob3JpemVDb2RlRGF0YS5jcmVhdGVkICsgNjAwCgogICAgICAvLyBJc3N1ZSBib3RoIHRoZSBwcmUtYXV0aG9yaXplZCBjb2RlIGFuZCB0aGUgdXNlciBQSU4KICAgICAgdmFyIHByZUF1dGhvcml6ZWRDb2RlSXNzdWVSZXN1bHQgPSBjb250ZXh0LnByZUF1dGhvcml6ZWRDb2RlSXNzdWVyLmlzc3VlKAogICAgICAgICAgICAgIHByZUF1dGhvcml6ZUNvZGVEYXRhCiAgICAgICk7CiAgICAgIC8vIFJlc3BvbnNlIHdpbGwgY29udGFpbiB0aGUgZm9sbG93aW5nIGZpZWxkcwogICAgICByZXR1cm4gewogICAgICAgICAgInByZS1hdXRob3JpemVkX2NvZGVfZXhwaXJlc19pbiI6IHNlY29uZHNVbnRpbChwcmVBdXRob3JpemVDb2RlRGF0YS5leHBpcmVzKSwKICAgICAgICAgICJwcmUtYXV0aG9yaXplZF9jb2RlIjogcHJlQXV0aG9yaXplZENvZGVJc3N1ZVJlc3VsdC5wcmVBdXRob3JpemVkQ29kZSwKICAgICAgICAgICJ1c2VyX3BpbiI6IHByZUF1dGhvcml6ZWRDb2RlSXNzdWVSZXN1bHQudXNlclBpbgogICAgICB9OwoKICB9</script>
      </token-procedure>
    </procedures>
    <account-managers>
      <account-manager>
        <id>default-account-manager</id>
        <enable-registration>
          <account-verification-method>no-verification</account-verification-method>
        </enable-registration>
        <account-data-source>default-datasource</account-data-source>
      </account-manager>
    </account-managers>
    <credential-managers>
      <credential-manager>
        <id>default-credential-manager</id>
        <Sha2WithSha256>
        </Sha2WithSha256>
        <data-source-backed>
          <data-source-id>default-datasource</data-source-id>
        </data-source-backed>
      </credential-manager>
    </credential-managers>
  </processing>
  <nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm">
    <write-default>permit</write-default>
    <groups>
      <group>
        <name>admin</name>
        <user-name>admin</user-name>
      </group>
    </groups>
    <rule-list>
      <name>admin</name>
      <group>admin</group>
      <rule>
        <name>any-access</name>
        <action>permit</action>
      </rule>
    </rule-list>
    <rule-list>
      <name>any-group</name>
      <group>*</group>
      <rule>
        <name>tailf-aaa-authentication</name>
        <module-name>tailf-aaa</module-name>
        <path>/aaa/authentication/users/user[name='$USER']</path>
        <access-operations>read update</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-aaa-user</name>
        <module-name>tailf-aaa</module-name>
        <path>/user[name='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
      <rule>
        <name>tailf-webui-user</name>
        <module-name>tailf-webui</module-name>
        <path>/webui/data-stores/user-profile[username='$USER']</path>
        <access-operations>create read update delete</access-operations>
        <action>permit</action>
      </rule>
    </rule-list>
  </nacm>
  <aaa xmlns="http://tail-f.com/ns/aaa/1.1">
    <authentication>
      <users>
        <user>
          <name>admin</name>
          <uid>0</uid>
          <gid>0</gid>
          <password>$5$fJasQB3l$Q7ojWWxQ/5yOvhzwlBtb84FtKKye1rWr.SzZbQyfJGD</password>
          <ssh_keydir>/opt/idsvr/home/admin/.ssh</ssh_keydir>
          <homedir>/opt/idsvr/home/admin</homedir>
        </user>
      </users>
    </authentication>
    <ios>
      <level>
        <nr>0</nr>
        <prompt>\h> </prompt>
      </level>
      <level>
        <nr>15</nr>
        <prompt>\h# </prompt>
      </level>
      <privilege>
        <mode>exec</mode>
        <level>
          <nr>0</nr>
          <command>
            <name>action</name>
          </command>
          <command>
            <name>autowizard</name>
          </command>
          <command>
            <name>enable</name>
          </command>
          <command>
            <name>exit</name>
          </command>
          <command>
            <name>help</name>
          </command>
          <command>
            <name>startup</name>
          </command>
        </level>
        <level>
          <nr>15</nr>
          <command>
            <name>configure</name>
          </command>
        </level>
      </privilege>
    </ios>
  </aaa>
</config>
